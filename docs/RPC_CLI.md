#RPC/CLI

The setup for the node RPC server and the CLI are based on the Bitcoin daemon/CLI setup, with all the software contained within one executable, shipped with a second executable that communicates with the daemon over RPC calls. As an addition, the CLI for dusk will open up a shell-like interface in the terminal if no commands are passed on startup. This configuration is open for change, as porting the code will not be a huge problem. For the type of network we are building however, I believe a setup like this one is favorable over a CryptoNote inspired setup (with wallet/wallet-cli being a seperate executable). Depending on how the node gets built from here on, having wallet code contained in the node will be much more simple, as it allows for the process to simply start up and begin working as a generator or provisioner (if specified in .conf or some other way) without having to start up a wallet-cli process as well and manually committing coins.

###RPC server

The RPC server is loosely based on the RPC server used by the Bitcoin client. On startup, the server will listen on a specified port on localhost, and accept method calls through a JSON format. The server will respond with a JSON response including the result of the function called, and an error message if one was encountered during function execution. In case of an unauthenticated user calling an admin level command, the server will send back a 401 Unauthorized response, along with an error message specifying which command was called.

###CLI executable

The CLI executable is a standalone binary which should be compiled on build. It provides a simple terminal interface that takes commands and sends them over to the RPC server on the specified port. Specifications like the username, password and server port are read from the dusk.conf file in the same folder (which will be created if it doesn't exist) and are used to populate requests with authorization data and point the requests in the right direction. If username and password match between the user and the server, then the user is allowed to call admin commands as well as normal commands.

Usage of the CLI executable is fairly simple. You can run the executable from the command line like the bitcoin-cli executable. Flags are parsed on startup, which will overwrite any config settings, and if no methods are passed in the command line, the CLI will start scanning for terminal input. Flag information and available commands are printed on startup.

###Commands

Commands are designed to be implemented as easily as possible. To add a command, you will have to add it to the `commands` array in `commands.go` located in `dusk-cli`. The `init()` function will include the command into the `cmdMap` mapping on startup. Then, in folder `rpc`, file `commands.go`, you will have to add the method name (lowercase) as well as it's handler function to the `RPCCmd` mapping. If the command is intended for admin use only, include the method name and a `true` bool in `RPCAdminCmd` as well. Then below, you should declare the handler function and make it do what you wish. In the future, it will make sense to seperate these handlers based on several categories in multiple Go files, but for now this should work.